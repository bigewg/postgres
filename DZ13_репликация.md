1. Создаем виртуалку (2CPU 2Gb) и устанавливаем постгрес 15.    
```
sudo apt update && sudo apt upgrade -y -q && sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list' && wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add - && sudo apt-get update && sudo apt -y install postgresql-15
```

2. Создаем, БД, таблицы, публикацию,  меняем режим журналрования и рестартуем кластер:  
``` 
bigewg@dz14-1:~$ sudo -u  postgres -i 
postgres@dz14-1:~$ psql
postgres=# ALTER SYSTEM SET wal_level = logical;
postgres=# create database dz14_1;
postgres=# \c dz14_1
dz14_1=# create table test1 as 
         select generate_series(1,10) as id, 'test1' as fio;
dz14_1=# create table test2 (id integer, fio  varchar);
dz14_1=# CREATE PUBLICATION test1_pub FOR TABLE test1;
postgres=# exit
postgres@dz14-1:~$pg_ctlcluster 15 main restart
```

3. Открываем удаленный доступ в наш кдастер:  
```
postgres@dz14-1:~$ vi /etc/postgresql/15/main/pg_hba.conf
host    replication     postgres        0.0.0.0/0               scram-sha-256
postgres@dz14-1:~$ vi /etc/postgresql/15/main/postgresql.conf 
listen_addresses = '*'            # what IP address(es) to listen on;
```

4. Аналогично поступаем со 2-ым кластером.  
5. Создаем подписку:  
```
dz14_1=# CREATE SUBSCRIPTION test2_sub 
CONNECTION 'host=158.160.31.17 port=5432 user=postgres password=qwe123 dbname=dz14_2' 
PUBLICATION test2_pub WITH (copy_data = true);
```


